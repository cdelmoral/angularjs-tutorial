"use strict";!function(){angular.module("angularjsTutorial",["angularjsTutorial.core","angularjsTutorial.sessions","angularjsTutorial.page","angularjsTutorial.users"])}(),function(){angular.module("angularjsTutorial.constants",[]).constant("environment",{ENV:"production",SERVER_URL:"https://cdelmoral-angularjstutorial.herokuapp.com"})}(),function(){angular.module("angularjsTutorial.common",[])}(),function(){angular.module("angularjsTutorial.core",["angularjsTutorial.sessions"])}(),function(){angular.module("angularjsTutorial.page",["ngRoute"])}(),function(){angular.module("angularjsTutorial.sessions",["angular-flash.service","angular-flash.flash-alert-directive","angularjsTutorial.common","angularjsTutorial.page","angularjsTutorial.constants"])}(),function(){angular.module("angularjsTutorial.users",["ngResource","ngMessages","angularUtils.directives.dirPagination","angular-flash.service","angular-flash.flash-alert-directive","angularjsTutorial.common","angularjsTutorial.page","angularjsTutorial.constants"])}(),function(){function a(){function a(a,b,c){var d=c.confirm||"Are you sure?";b.bind("click",function(a){confirm(d)||(a.stopImmediatePropagation(),a.preventDefault)})}var b={restrict:"A",link:{pre:a}};return b}angular.module("angularjsTutorial.common").directive("atConfirm",a)}(),function(){function a(){function a(a,b,c,d){function e(b,c){var d=b||c;return d===a.password}d.$validators.atConfirmPassword=e,a.$watch("password",function(){d.$validate()})}var b={require:"ngModel",scope:{password:"=atConfirmPassword"},link:a};return b}angular.module("angularjsTutorial.common").directive("atConfirmPassword",a)}(),function(){function a(a){function b(a){function b(){g=!0}function c(a){f=a}function d(a){return f?a?a.$invalid&&(a.$dirty||g):f&&f.$invalid&&(f.$dirty||g):!1}var e=this,f=null,g=!1;e.setFormCtrl=c,e.needsAttention=d,e.setAttempted=b}function c(b,c,d){function e(a,b,c,d){var e=d[0],f=d.length>1?d[1]:null;e.setFormCtrl(f),a.at=a.at||{},a.at[c.name]=e}function f(b,c,d,e){var f=e[0],g=e.length>1?e[1]:null,h=a(d.atSubmit);c.bind("submit",function(a){return b.$apply(function(){f.setAttempted()}),g.$valid?void b.$apply(function(){h(b,{$event:a})}):!1})}var g={pre:e,post:f};return g}var d={restrict:"A",require:["atSubmit","?form"],controller:b,compile:c};return b.$inject=["$scope"],d}angular.module("angularjsTutorial.common").directive("atSubmit",a),a.$inject=["$parse"]}(),function(){function a(a,b,c){function d(c,d,e,f){function g(d,f){var g=b.defer(),h=d||f,i=a(e.atValidateUnique);return i(c,{value:h}).then(function(){g.resolve()},function(){g.reject()}),g.promise}f.$asyncValidators.atValidateUnique=g}var e={restrict:"A",require:"ngModel",link:d};return e}angular.module("angularjsTutorial.common").directive("atValidateUnique",a),a.$inject=["$parse","$q","UsersService"]}(),function(){function a(a,b){var c=this;c.userLoggedIn=!1,c.currentUser=null,a.$on(b.LOGGING_EVENT,function(){c.userLoggedIn=null!==b.currentUser,c.currentUser=b.currentUser})}angular.module("angularjsTutorial.core").controller("HeaderCtrl",a),a.$inject=["$scope","SessionsService"]}(),function(){function a(a){a.setPageTitle("About")}angular.module("angularjsTutorial.page").controller("AboutCtrl",a),a.$inject=["PageSvc"]}(),function(){function a(a){a.setPageTitle("Contact")}angular.module("angularjsTutorial.page").controller("ContactCtrl",a),a.$inject=["PageSvc"]}(),function(){function a(a){a.setPageTitle("Help")}angular.module("angularjsTutorial.page").controller("HelpCtrl",a),a.$inject=["PageSvc"]}(),function(){function a(a,b){function c(){d.userLoggedIn=null!==b.currentUser,a.setPageTitle("Home")}var d=this;d.userLoggedIn=!1,c()}angular.module("angularjsTutorial.page").controller("HomeCtrl",a),a.$inject=["PageSvc","SessionsService"]}(),function(){function a(a){function c(c){c&&""!==c?a.title=c+" - "+b:a.title=b}var d=this;return d.setPageTitle=c,d}angular.module("angularjsTutorial.page").factory("PageSvc",a);var b="AngularJS Tutorial";a.$inject=["$rootScope"]}(),function(){function a(a,b){function c(){null!==b.currentUser&&b.logout(),a.path("/home").replace()}c()}angular.module("angularjsTutorial.sessions").controller("SessionsDeleteCtrl",a),a.$inject=["$location","SessionsService"]}(),function(){function a(a,b,c,d){function e(){d.authenticate(g.user).then(function(c){b.success="Welcome!",null===d.beforeLoginAttempt?a.path("/users/"+c.id).replace():(a.path(d.beforeLoginAttempt).replace(),d.beforeLoginAttempt=null)})["catch"](function(){b.error="Invalid login",a.path("/login").replace()})}function f(){d.currentUser&&a.path("/users/"+d.currentUser.id).replace(),c.setPageTitle("Log in")}var g=this;g.user={},g.createSession=e,f()}angular.module("angularjsTutorial.sessions").controller("SessionsNewCtrl",a),a.$inject=["$location","flash","PageSvc","SessionsService"]}(),function(){function a(a,b,c,d,e,f){function g(a){var c=b.defer();return m.authenticate(a,function(a){a&&a.id?(l.currentUser=a,d.$broadcast(l.LOGGING_EVENT),c.resolve(l.currentUser)):c.reject()}),c.promise}function h(){m.logout(),l.currentUser=null,d.$broadcast(l.LOGGING_EVENT),a.path("/home").replace()}function i(){null===l.currentUser&&(l.beforeLoginAttempt=a.path(),f.error="You need to be logged in to access this page",a.path("/login").replace())}function j(b){i(),l.currentUser.id!==b&&(f.error="You don't have permissions to access this page.",a.path("/users/"+l.currentUser.id))}function k(){var a=b.defer();m.authenticated(function(b){b&&b.id&&(l.currentUser=b,d.$broadcast(l.LOGGING_EVENT)),a.resolve()}),l.initAuthPromise=a.promise}var l=this;l.LOGGING_EVENT="LoggingEvent",l.initAuthPromise=null,l.currentUser=null,l.beforeLoginAttempt=null,l.authenticate=g,l.logout=h,l.initialize=k,l.requireLogin=i,l.requireCorrectUser=j;var m=c(e.SERVER_URL+"/api/sessions",{},{authenticate:{method:"POST"},authenticated:{method:"GET",url:e.SERVER_URL+"/api/sessions/authenticated"},logout:{method:"DELETE",url:e.SERVER_URL+"/api/sessions/logout"}});return l}angular.module("angularjsTutorial.sessions").factory("SessionsService",a),a.$inject=["$location","$q","$resource","$rootScope","environment","flash"]}(),function(){function a(a,b,c,d,e,f,g){function h(){f.updateUser(l.user).then(function(b){b&&b.id&&(g.success="Your profile was successfully updated!",e.currentUser=b,a.path(f.userPath(b)).replace())})}function i(a){return f.isNameUnique(a)}function j(a){return f.isEmailUnique(a)}function k(){e.requireCorrectUser(c.id),d.setPageTitle("Edit user"),l.user=f.getUser(c.id)}var l=this;l.user={},l.confirmation="",l.updateUser=h,l.isNameUnique=i,l.isEmailUnique=j,k()}angular.module("angularjsTutorial.users").controller("UsersEditCtrl",a),a.$inject=["$location","$q","$routeParams","PageSvc","SessionsService","UsersService","flash"]}(),function(){function a(a,b,c){function d(){return b.currentUser.admin}function e(a){c.getUsersPage(a,h.usersPerPage).then(function(a){h.users=a.users,h.totalUsers=a.count})}function f(a){c.deleteUser(a).then(function(){e(h.pagination.current)})}function g(){b.requireLogin(),a.setPageTitle("Users"),e(h.pagination.current)}var h=this;h.CONFIRM="Are you sure you want to delete the User?",h.users=[],h.totalUsers=0,h.usersPerPage=10,h.pagination={current:1},h.userIsAdmin=d,h.getUsersPage=e,h.deleteUser=f,g()}angular.module("angularjsTutorial.users").controller("UsersIndexCtrl",a),a.$inject=["PageSvc","SessionsService","UsersService"]}(),function(){function a(a,b,c,d,e){function f(){k||(k=!0,d.createUser(j.user).then(function(b){k=!1,b&&b.id&&(e.success="Welcome to the sample app!",c.authenticate(j.user).then(function(b){a.path(d.userPath(b)).replace()}))}))}function g(a){return d.isNameUnique(a)}function h(a){return d.isEmailUnique(a)}function i(){c.currentUser&&a.path(d.userPath(c.currentUser)).replace(),b.setPageTitle("Sign up")}var j=this;j.user={},j.confirmation="",j.createUser=f,j.isNameUnique=g,j.isEmailUnique=h;var k=!1;i()}angular.module("angularjsTutorial.users").controller("UsersNewCtrl",a),a.$inject=["$location","PageSvc","SessionsService","UsersService","flash"]}(),function(){function a(a,b,c){function d(a){return m.save(a).$promise}function e(a){return m.update({id:a.id},a).$promise}function f(b,c){var d=a.defer(),e={pageNumber:b,usersPerPage:c};return m.queryPage(e).$promise.then(function(a){d.resolve(a)}),d.promise}function g(a){return m.get({id:a})}function h(a){return console.log("aro"),m["delete"](a).$promise}function i(a){return a&&a.id?"/users/"+a.id:void 0}function j(b){var c=a.defer();return m.isNameAvailable({name:b}).$promise.then(function(a){a&&a.valid?c.resolve():c.reject()}),c.promise}function k(b){var c=a.defer();return m.isEmailAvailable({email:b}).$promise.then(function(a){a&&a.valid?c.resolve():c.reject()}),c.promise}var l={};l.createUser=d,l.updateUser=e,l.getUsersPage=f,l.getUser=g,l.userPath=i,l.isNameUnique=j,l.isEmailUnique=k,l.deleteUser=h;var m=b(c.SERVER_URL+"/api/users/:id",{},{queryPage:{method:"GET",params:{pageNumber:1,usersPerPage:25},url:c.SERVER_URL+"/api/users/index_page"},update:{method:"PUT"},isNameAvailable:{method:"GET",url:c.SERVER_URL+"/api/users/valid_name"},isEmailAvailable:{method:"GET",url:c.SERVER_URL+"/api/users/valid_email"}});return l}angular.module("angularjsTutorial.users").factory("UsersService",a),a.$inject=["$q","$resource","environment"]}(),function(){function a(a,b,c,d){function e(){c.requireLogin(),b.setPageTitle("Show user"),f.user=d.getUser(a.id)}var f=this;f.user={},e()}angular.module("angularjsTutorial.users").controller("UsersShowCtrl",a),a.$inject=["$routeParams","PageSvc","SessionsService","UsersService"]}(),function(){function a(a){a.initialize()}function b(a,b){function c(a){return a.initAuthPromise}delete a.defaults.headers.common["X-Requested-With"];var d={auth:c};c.$inject=["SessionsService"],b.when("/home",{templateUrl:"components/page/home.html",controller:"HomeCtrl",controllerAs:"ctrl",resolve:d}).when("/help",{templateUrl:"components/page/help.html",controller:"HelpCtrl",resolve:d}).when("/about",{templateUrl:"components/page/about.html",controller:"AboutCtrl",resolve:d}).when("/contact",{templateUrl:"components/page/contact.html",controller:"ContactCtrl",resolve:d}).when("/sign-up",{templateUrl:"components/users/users-new.html",controller:"UsersNewCtrl",controllerAs:"ctrl",resolve:d}).when("/users",{templateUrl:"components/users/users-index.html",controller:"UsersIndexCtrl",controllerAs:"ctrl",resolve:d}).when("/users/:id",{templateUrl:"components/users/users-show.html",controller:"UsersShowCtrl",controllerAs:"ctrl",resolve:d}).when("/users/:id/edit",{templateUrl:"components/users/users-edit.html",controller:"UsersEditCtrl",controllerAs:"ctrl",resolve:d}).when("/login",{templateUrl:"components/sessions/sessions-new.html",controller:"SessionsNewCtrl",controllerAs:"ctrl",resolve:d}).when("/logout",{template:" ",controller:"SessionsDeleteCtrl",resolve:d}).otherwise({redirectTo:"/home"})}angular.module("angularjsTutorial").run(a).config(b),a.$inject=["SessionsService"],b.$inject=["$httpProvider","$routeProvider"]}();